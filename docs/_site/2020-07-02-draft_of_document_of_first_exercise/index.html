<!DOCTYPE html>
<html lang="en">
  <!-- Beautiful Jekyll | MIT license | Copyright Dean Attali 2020 -->
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Draft of document of first exercise</title>
  
  
  <meta name="author" content="Yijia Wu">
  
  
  

  <link rel="alternate" type="application/rss+xml" title="GSoC 2020 Blog - Yijia Wu - GSoC progress" href="http://localhost:4000/feed.xml">

  

  

  


  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/main.css">
    
  

  

  

  <!-- Facebook OpenGraph tags -->
  

  
  <meta property="og:title" content="Draft of document of first exercise">
  

   
  <meta property="og:description" content="This is a draft of the document of first exercise. The goal of this exercise is to learn the underlying infrastructure of Industrial Robot exercises(ROS + MoveIt + our own industrial robotics API) and get familiar with the key components needed for more complex exercises by completing the task of...">
  


  <meta property="og:type" content="website">

  
  <meta property="og:url" content="http://localhost:4000/2020-07-02-draft_of_document_of_first_exercise/">
  <link rel="canonical" href="http://localhost:4000/2020-07-02-draft_of_document_of_first_exercise/">
  

  
  <meta property="og:image" content="http://localhost:4000/img/logo.png">
  


  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">

  
  <meta name="twitter:title" content="Draft of document of first exercise">
  

  
  <meta name="twitter:description" content="This is a draft of the document of first exercise. The goal of this exercise is to learn the underlying infrastructure of Industrial Robot exercises(ROS + MoveIt + our own industrial robotics API) and get familiar with the key components needed for more complex exercises by completing the task of...">
  

  
  <meta name="twitter:image" content="http://localhost:4000/img/logo.png">
  

  

  

</head>


  <body>

    

  
    <nav class="navbar navbar-expand-md navbar-light fixed-top navbar-custom "><a class="navbar-brand" href="http://localhost:4000/">GSoC 2020 Blog - Yijia Wu</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="https://theroboticsclub.github.io/colab-gsoc2020-Yijia_Wu">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/aboutme">About Me</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About Project</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/aboutproject">Introduction</a>
                  <a class="dropdown-item" href="/progress">Progress</a>
            </div>
          </li>
        </ul>
  </div>

  
    <div class="avatar-container">
      <div class="avatar-img-border">
        <a href="http://localhost:4000/">
          <img alt="Navbar avatar" class="avatar-img" src="/img/logo.png" />
        </a>
      </div>
    </div>
  

</nav>


    <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="post-heading">
          <h1>Draft of document of first exercise</h1>
      
      
      
          <span class="post-meta">Posted on July 2, 2020</span>
          
      
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class="container-md">
  <div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">

      

      <article role="main" class="blog-post">
        <p><strong>This is a draft of the document of first exercise.</strong></p>

<p>The goal of this exercise is to learn the underlying infrastructure of Industrial Robot exercises(ROS + MoveIt + our own industrial robotics API) and get familiar with the key components needed for more complex exercises by completing the task of pick and place multiple objects and classify them by color or shape.</p>

<p><img src="https://raw.githubusercontent.com/TheRoboticsClub/colab-gsoc2020-Yijia_Wu/master/docs/img/new_first_exercise_world.png" alt="world" class="mx-auto d-block" /></p>

<h2 id="installation">Installation</h2>
<ol>
  <li>Install the <a href="https://jderobot.github.io/RoboticsAcademy/installation/#generic-infrastructure">General Infrastructure</a> of the JdeRobot Robotics Academy.</li>
  <li>Install MoveIt
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>ros-melodic-moveit
<span class="nb">sudo </span>apt-get <span class="nb">install </span>ros-melodic-ros-control ros-melodic-ros-controllers
</code></pre></div>    </div>
  </li>
  <li>Install Industrial Robot package
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> catkin_ws/src
<span class="nb">cd </span>catkin_ws/src
</code></pre></div>    </div>
    <p>after pull request to the industrial robot repo</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/JdeRobot/IndustrialRobotics.git <span class="nt">-b</span> pick_place_basic
<span class="nb">cd</span> ..
</code></pre></div>    </div>
    <p>Update ROS dependencies</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rosdep update
rosdep check <span class="nt">--from-paths</span> <span class="nb">.</span> <span class="nt">--ignore-src</span> <span class="nt">--rosdistro</span> melodic
rosdep <span class="nb">install</span> <span class="nt">--from-paths</span> <span class="nb">.</span> <span class="nt">--ignore-src</span> <span class="nt">--rosdistro</span> melodic <span class="nt">-y</span>
</code></pre></div>    </div>
    <p>Build workspace</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>catkin build
</code></pre></div>    </div>
    <p>Export environment variables</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'source '</span><span class="nv">$PWD</span><span class="s1">'/devel/setup.bash'</span> <span class="o">&gt;&gt;</span> ~/.bashrc
<span class="nb">echo</span> <span class="s1">'export GAZEBO_MODEL_PATH=${GAZEBO_MODEL_PATH}:'</span><span class="nv">$PWD</span><span class="s1">'/src/IndustrialRobotics/industrial_robot/models'</span> <span class="o">&gt;&gt;</span> ~/.bashrc
<span class="nb">source</span> ~/.bashrc
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="how-to-run-the-exercise">How to run the exercise</h2>
<p>TO launch the exercise, open a terminal windows, navigate to the ROS workspace which contains Industrial Robot folder and execute following command:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>roslaunch industrial_robot pick_place_basic.launch 
</code></pre></div></div>
<p>Two different windows will pop up:</p>
<ul>
  <li><strong>Gazebo simulator</strong>: A warehouse environment with a industrial robot(robot arm and gripper), multiple objects, a conveyor and two boxes will be shown in Gazebo.</li>
  <li><strong>Industrial robot teleoperator</strong>: A GUI which provideds following functionalities:
    <ul>
      <li>A Forward Kinematics teleoperator providing sliders to change the angle of each joint of the robot arm and the gripper. The limits of each joints are shown in the two sides of the slider. The true angle of the joints are shown in the text box beside the sliders.</li>
      <li>An Inverse Kinematics teleoperator allowing users to set the desired end effector pose.
        <ul>
          <li>Plan button can plan the trajectory to the desired pose</li>
          <li>Excute button can make the robot execute the planned trajectory</li>
          <li>Plan &amp; Execute button is the integration of last two buttons</li>
          <li>Stop button allows users to stop the robot</li>
          <li>Back to home button can make the robot move back to home pose</li>
        </ul>
      </li>
      <li>Two update button can update the value of current robot state</li>
      <li>Code Manager part
        <ul>
          <li>Four buttons to start, stop, pause and restart the main code you program</li>
          <li>One button to launch Rviz</li>
          <li>One button to Respawn all objects in Gazebo and Rviz</li>
          <li>An info box showing the status of the main code(“start” or “stop”)</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="https://raw.githubusercontent.com/TheRoboticsClub/colab-gsoc2020-Yijia_Wu/master/docs/img/newGUI.png" alt="GUI" class="mx-auto d-block" /></p>

<p>Then open a new terminal window, navigate to <code class="highlighter-rouge">exercise</code> folder and execute following command:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python MyAlgorithm.py
</code></pre></div></div>

<h2 id="how-should-i-solve-the-exercise">How should I solve the exercise</h2>
<p>To solve the exercise, you must edit the MyAlgorithm.py file and insert control logic in myalgorithm() function. The path of this file is “src/rqt_kinematics/src/rqt_kinematics/interfaces/MyAlgorithm.py” inside the catkin_ws folder.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">myalgorithm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stopevent</span><span class="p">,</span> <span class="n">pauseevent</span><span class="p">):</span>
	<span class="c1">############## Insert your code here ###############
</span>    <span class="c1"># Move the robot back to home as a start
</span>    <span class="bp">self</span><span class="p">.</span><span class="n">pick_place</span><span class="p">.</span><span class="n">back_to_home</span><span class="p">()</span>
	
    <span class="c1"># insert following two lines where you want to pause or stop the algorithm 
</span>    <span class="c1"># with the stop button in GUI
</span>    <span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">pauseevent</span><span class="p">.</span><span class="n">isSet</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">stopevent</span><span class="p">.</span><span class="n">isSet</span><span class="p">()):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">stopevent</span><span class="p">.</span><span class="n">isSet</span><span class="p">():</span>
            <span class="k">return</span>

    <span class="c1">##### A brief example to pick and place object "blue_ball" #####
</span>    <span class="n">object_name</span> <span class="o">=</span> <span class="s">"blue_ball"</span>
    <span class="c1"># get object pose
</span>    <span class="n">pose</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">pick_place</span><span class="p">.</span><span class="n">get_object_pose</span><span class="p">(</span><span class="n">object_name</span><span class="p">)</span>

    <span class="c1"># generate grasp message and pick it up
</span>    <span class="c1"># parameters WIDTH and LENGTH need to be tuned according to the object and grasping pose
</span>    <span class="n">WIDTH</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">LENGTH</span> <span class="o">=</span> <span class="mf">0.15</span>
    <span class="n">grasp</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">pick_place</span><span class="p">.</span><span class="n">generate_grasp</span><span class="p">(</span><span class="n">object_name</span><span class="p">,</span> <span class="s">"vertical"</span><span class="p">,</span> <span class="n">pose</span><span class="p">.</span><span class="n">position</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">LENGTH</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">pick_place</span><span class="p">.</span><span class="n">pickup</span><span class="p">(</span><span class="n">object_name</span><span class="p">,</span> <span class="p">[</span><span class="n">grasp</span><span class="p">])</span>

    <span class="c1"># setup stop signal detector
</span>    <span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">pauseevent</span><span class="p">.</span><span class="n">isSet</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">stopevent</span><span class="p">.</span><span class="n">isSet</span><span class="p">()):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">stopevent</span><span class="p">.</span><span class="n">isSet</span><span class="p">():</span>
            <span class="k">return</span>

    <span class="c1"># choose target position and place the object
</span>    <span class="n">target_name</span> <span class="o">=</span> <span class="s">"blue_target"</span>
    <span class="n">place_position</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">pick_place</span><span class="p">.</span><span class="n">get_target_position</span><span class="p">(</span><span class="n">target_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">pick_place</span><span class="p">.</span><span class="n">place</span><span class="p">(</span><span class="s">"vertical"</span><span class="p">,</span> <span class="n">place_position</span><span class="p">)</span>

    <span class="c1">####################################################
</span>

</code></pre></div></div>
<p>Multiple APIs can be used to implement your algorithm. They are provided in Pick_Place class, so you should allways add “self.pick_place.” as a prefix to following introduced APIs in your algorithm.</p>

<h2 id="api">API</h2>
<h3 id="environment-information">Environment Information</h3>
<ul>
  <li><code class="highlighter-rouge">get_object_list()</code> - Return the name list of all objects.</li>
  <li><code class="highlighter-rouge">get_object_pose(object_name)</code> - Return the pose of the object.</li>
  <li><code class="highlighter-rouge">get_object_info(object_name)</code> - Return the pose, height, eidth, length, shape, color of the object in order.</li>
  <li><code class="highlighter-rouge">get_target_list()</code> - Return the name list of all targets.</li>
  <li><code class="highlighter-rouge">get_target_position(target_name)</code> - Return the position of target where we are going to place the objects.</li>
</ul>

<h3 id="convert-pose-message">Convert Pose Message</h3>
<ul>
  <li><code class="highlighter-rouge">pose2msg(roll, pitch, yaw, x, y, z)</code> - Convert pose to Pose message. The unit of roll, pitch, yaw is radian.</li>
  <li><code class="highlighter-rouge">pose2msg_deg(roll, pitch, yaw, x, y, z)</code> - Convert pose to Pose message. The unit of roll, pitch, yaw is degree.</li>
  <li><code class="highlighter-rouge">msg2pose(pose)</code> - Convert Pose message to pose, return roll, pitch, yaw, x, y, z in order. The unit of roll, pitch, yaw is radian.</li>
  <li><code class="highlighter-rouge">msg2pose_deg(pose)</code> - Convert Pose message to pose, return roll, pitch, yaw, x, y, z in order. The unit of roll, pitch, yaw is degree.</li>
</ul>

<h3 id="basic-robot-movement">Basic Robot Movement</h3>
<ul>
  <li><code class="highlighter-rouge">move_pose_arm(pose_goal)</code> - Command the robot with Pose message to make its end effector frame move to the desired pose with inverse kinematics.</li>
  <li><code class="highlighter-rouge">move_joint_arm(joint_0,joint_1,joint_2,joint_3,joint_4,joint_5)</code> - Command the robot joints to move to desired joints value</li>
  <li><code class="highlighter-rouge">move_joint_hand(joint_value)</code> - Command the gripper joint to move to desired joint value.</li>
  <li><code class="highlighter-rouge">back_to_home()</code> - Command the robot arm and gripper to move back to the home pose.</li>
</ul>

<h3 id="setup-grasp-message">Setup Grasp message</h3>
<p><a href="http://docs.ros.org/melodic/api/moveit_msgs/html/msg/Grasp.html">Grasp message</a> contains the informations that the MoveIt pick function requires.</p>
<ul>
  <li><code class="highlighter-rouge">generate_grasp(object_name, eef_orientation, position, [width, roll, pitch, yaw, length])</code> - Returns the specified Grasp message according to related setup.
    <ul>
      <li><code class="highlighter-rouge">eef_orientaion</code> is to clarify the desired end effector orientation.
        <ul>
          <li><code class="highlighter-rouge">horizontal</code>: grasp the object with a horizontal gripper orientation. (default value: roll = pitch = yaw = 0. <code class="highlighter-rouge">pitch</code> is setable.)</li>
          <li><code class="highlighter-rouge">vertical</code>: grasp the object with a vertical gripper orientation. (default value: roll = 0, pitch = 90°, yaw = 0. <code class="highlighter-rouge">yaw</code> is setable.)</li>
          <li><code class="highlighter-rouge">user_defined</code>: grasp the object with a user defined gripper orientation. (default value: roll = pitch = yaw = 0. <code class="highlighter-rouge">roll</code>,<code class="highlighter-rouge">pitch</code>,<code class="highlighter-rouge">yaw</code> are all setable)</li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">position</code> is the position of the end effector when grasping the object</li>
      <li><code class="highlighter-rouge">width</code> is the value the gripper joints should move to grasp the object with a range of [0, 0.8]. If you keep the default value 0, the <code class="highlighter-rouge">eef_orientation</code> is <code class="highlighter-rouge">horizontal</code> or <code class="highlighter-rouge">vertical</code> and the default rpy angle values are kept, this width value will be set depend on the object width.</li>
      <li><code class="highlighter-rouge">roll</code>,<code class="highlighter-rouge">pitch</code>,<code class="highlighter-rouge">yaw</code> are optional parameters.</li>
      <li><code class="highlighter-rouge">length</code> is the offset length from the your desired gripper position to robot tool center. When you input grasping pose, you are specifying the pose of the desired gripper position. The default value is 0, which means you are specifying the pose of the tool center of the robot arm when the robot is grasping the object.</li>
    </ul>
  </li>
</ul>

<p>The default minimum grasp distance and desired distance are set to be 0.2(m) and 0.1(m). The default approach direction is set to be (0, 0, -0.5). You can keep them or modify them with following functions:</p>
<ul>
  <li><code class="highlighter-rouge">set_grasp_distance(min_distance, desired_distance)</code> - Set the minmum distance and desired distance the gripper translates before and after grasping.</li>
  <li><code class="highlighter-rouge">set_grasp_direction(x, y, z)</code> - Set the direction of the gripper approach translation before grasping. Retreat translation distance will set to be the opposite direction of the approach direction.</li>
</ul>

<h3 id="pick-and-place">Pick and Place</h3>
<ul>
  <li><code class="highlighter-rouge">pickup(object_name, grasps)</code> - Command the industrial robot to pick up the object with a list of genrated Grasp messages.</li>
  <li><code class="highlighter-rouge">place(eef_orientation, position[, distance, roll, pitch, yaw])</code> - Command the industrial robot to place the currently holding object to goal_position with desired end effector orientation.
    <ul>
      <li><code class="highlighter-rouge">eef_orientaion</code> is to clarify the desired end effector orientation.
        <ul>
          <li><code class="highlighter-rouge">horizontal</code>: grasp the object with a horizontal gripper orientation. (default value: roll = 0, pitch = 0, yaw = 180°. <code class="highlighter-rouge">pitch</code> is setable.)</li>
          <li><code class="highlighter-rouge">vertical</code>: grasp the object with a vertical gripper orientation. (default value: roll = 0, pitch = 90°, yaw = 180°. <code class="highlighter-rouge">yaw</code> is setable.)</li>
          <li><code class="highlighter-rouge">user_defined</code>: grasp the object with a user defined gripper orientation. (default value: roll = 0, pitch = 0, yaw = 180°. <code class="highlighter-rouge">roll</code>,<code class="highlighter-rouge">pitch</code>,<code class="highlighter-rouge">yaw</code> are all setable)</li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">position</code> is the position of the end effector when placing the object</li>
      <li><code class="highlighter-rouge">distance</code> is the distance the robot arm will move in z axis when placing objects. The default value is 0.1(m)</li>
    </ul>
  </li>
</ul>

<h2 id="theory">Theory</h2>

<h3 id="robot-workspace">Robot Workspace</h3>
<p>Workspace is the space the end effector of the robot can reach. It is limited by the mechanical structure of the robot. The industrial robot providers usually provide the workspace or work range for their robot in the manual. For example, the following image is the work range of irb120 robot, the robot we use in this exercise.</p>

<p><img src="https://abbcloud.blob.core.windows.net/public/images/b7207bb0-410e-4ea7-bee3-3cbbe94b0a74/i1080px.jpg" alt="irb120" class="mx-auto d-block" /></p>

<p>When you are specifying the pose of the end effector to grasp or place the object, sometimes you will see a warning <code class="highlighter-rouge">***** GOAL POSE IS OUT OF ROBOT WORKSPACE *****</code> which is provided behind our API. However, as you can see, the workspace is complicated, so we only check whether the position is inside the outer sphere, outside of the inner sphere and above the bottom position. No warning doesn’t mean the position is inside the workspace.</p>

<p>Even if your specified position of the end effector is inside the workspace, if the orientation is not properly set, you are actually requiring other joints to move out of their workspaces.</p>

<h3 id="position-and-orientation">Position and Orientation</h3>
<p>In 3D space, a rigid body has six degrees of freedom. Its pose can be fully described by position, translations in three axies(x, y, z) from origin and orientation, rotation relative to reference frame. Position can be easily descirbe with (X, Y, Z) when coordinate frame is given. In our exercise, the reference frame is the robot frame with origin in its bottom center, x-axis pointing forward, y-axis pointing leftward and z-axis pointing upward.</p>

<p>By contrast, orientation is harder to describe. There are many different methods to describe orientation in 3D including rotation matrix, rotation vector, euler angle, quaternion. If you want to understand more about them and has linear algebra background, have a look of <a href="https://en.wikibooks.org/wiki/Robotics_Kinematics_and_Dynamics/Description_of_Position_and_Orientation">this page</a>. To finish this exercise, you only need to understand part of euler angle.</p>

<p>Roll, pitch, yaw are rotation angles around x, y, z axis. They are applied in order, such as x-y-z or z-y-x. Usually we use the new frame after each rotation as the new reference frame, but in <a href="http://wiki.ros.org/tf">tf</a>, a ROS library for managing coordinate frames, they choose static x-y-z euler angle as default method, which means each rotation will be applied with respect to(w.r.t.) the static original reference frame. Thus, in this exercise, roll, pitch, yaw will be applied in this x-y-z order w.r.t. the robot frame.</p>

<p>When you use the inverse kinematic tool in GUI, sometimes you will see that the input desired orientation is much different from the final orientation values, position also has tiny difference. The reason for the tiny difference is that when the difference between final pose and desired pose is within a given range, controller will stop. The reason for the large difference in orientation is that there are some other expressions that can also describe this orientation correctly.</p>

<p><strong>roll = 0, pitch = 0, yaw = 0</strong><br />
<img src="https://raw.githubusercontent.com/TheRoboticsClub/colab-gsoc2020-Yijia_Wu/master/docs/img/rpy000.png" alt="rpy000" class="mx-auto d-block" /></p>

<p><strong>roll = 90, pitch = 0, yaw = 0</strong><br />
<img src="https://raw.githubusercontent.com/TheRoboticsClub/colab-gsoc2020-Yijia_Wu/master/docs/img/roll90.png" alt="roll90" class="mx-auto d-block" /></p>

<p><strong>roll = 0, pitch = 90, yaw = 0</strong><br />
<img src="https://raw.githubusercontent.com/TheRoboticsClub/colab-gsoc2020-Yijia_Wu/master/docs/img/pitch90.png" alt="pitch90" class="mx-auto d-block" /></p>

<p><strong>roll = 0, pitch = 0, yaw = 90</strong><br />
<img src="https://raw.githubusercontent.com/TheRoboticsClub/colab-gsoc2020-Yijia_Wu/master/docs/img/yaw90.png" alt="yaw90" class="mx-auto d-block" /></p>

<h3 id="forward-kinematics-and-inverse-kinematics">Forward Kinematics and Inverse Kinematics</h3>
<p>Forward kinematics is given the value of each joints, to find the pose of the end effector. The pose is unique.<br />
Inverse kinematics is given the pose of the end effector, to find possible joints value and trajectory to move from start state to goal state. There are usully multiple solutions.</p>

<h2 id="hints">Hints</h2>

<h3 id="relationship-among-ros-moveit-rviz-gazebo-jderobot-provided-api">Relationship among ROS, MoveIt, Rviz, Gazebo, JdeRobot provided API</h3>
<ul>
  <li><a href="https://www.ros.org/">ROS</a>(Robot Operating System) is a robotics middleware which contains a set of open source libraries for developing robot applications.</li>
  <li><a href="https://moveit.ros.org/">MoveIt</a> is an open source Motion Planning framework for industrial robot which integrates motion planning, collision checking, manipulation, 3D perception capabilities.</li>
  <li><a href="http://wiki.ros.org/rviz">Rviz</a> is a 3D visualization tool for ROS. Many ROS topics can be visualized in Rviz, including the planning scene of MoveIt move group, but it does not contain any physics simulation capability.</li>
  <li><a href="http://gazebosim.org/">Gazebo</a> is a physics simulator mainly use for robot simulation.</li>
  <li>The APIs provided by JdeRobot Academy are based on the above tools, so the user don’t need to learn all of them to start simulation of industrial robot manipulation.</li>
</ul>

<h4 id="objects-visualization">Objects visualization</h4>
<p>When we start Gazebo with a world file, the objects in Gazebo will not be automatically added in the planning scene of MoveIt, so we can only see the robot in Rviz without any other objects. If we want MoveIt to know there are some objects in the environment, we should manually add them into the planning scene, but you don’t need to worry about it in this exercise as it has been done by us.</p>

<h4 id="obstacle-avoidance">Obstacle Avoidance</h4>
<p>After adding objects into planning scene, MoveIt will avoid planning trajectory for the robot that will lead to collision. However, because the object in planning scene cannot be updated automatically with their pose in Gazebo, after the robot grasping them, we cannot track their poses any more, so MoveIt cannot take them into consideration of obstacle avoidance.</p>

<h4 id="pick-and-place-1">Pick and Place</h4>
<p>Moveit provides pick and place functions. We can perform great pick and place in planning scene with them, but at the same time, you will see that the objects cannot be picked up in Gazebo. The reason for it is that Gazebo, as a physical simulator, still cannot simulate the contact between two surface perfectly. Even if we can see the robot pick up the object successfully in Rviz, it might not work in Gazebo.</p>

<h3 id="object-and-target-lists">Object and Target lists:</h3>
<p><strong>Object list:</strong></p>
<ul>
  <li>yellow_box</li>
  <li>red_box</li>
  <li>blue_box</li>
  <li>blue_ball</li>
  <li>yellow_ball</li>
  <li>green_ball</li>
  <li>green_cylinder</li>
  <li>red_cylinder</li>
</ul>

<p><strong>Target list:</strong></p>
<ul>
  <li>red_target</li>
  <li>green_target</li>
  <li>blue_target</li>
  <li>yellow_target</li>
</ul>

<h3 id="why-does-the-robot-sometimes-cannot-move-to-some-desired-pose">Why does the robot sometimes cannot move to some desired pose?</h3>
<p>The most possible reason is that your specified pose is unreachable for the robot arm, so MoveIt cannot plan a trajectory from current pose to desired pose in limited time. You will see such a warning when this problem happened:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fail: ABORTED: No motion plan found. No execution attempted.
</code></pre></div></div>
<h3 id="ignorable-error-and-warning">Ignorable ERROR and WARNING</h3>
<ul>
  <li><code class="highlighter-rouge">No p gain specified for pid.</code></li>
  <li><code class="highlighter-rouge">Controller is taking too long to execute trajectory</code></li>
  <li><code class="highlighter-rouge">Controller failed with error GOAL_TOLERANCE_VIOLATED</code></li>
</ul>

<h2 id="demonstration-video-of-the-solution">Demonstration video of the solution</h2>
<p><a href="https://youtu.be/kJMPz80w9BM"><img src="https://img.youtube.com/vi/kJMPz80w9BM/0.jpg" alt="solution" class="mx-auto d-block" /></a></p>

      </article>

      

      
        <!-- Check if any share-links are active -->





      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2020-06-25-week4/" data-toggle="tooltip" data-placement="top" title="Week4">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2020-07-12-week5_6/" data-toggle="tooltip" data-placement="top" title="Week5 and 6">Next Post &rarr;</a>
        </li>
        
      </ul>
              
  
  
  

  



    </div>
  </div>
</div>


    <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a href="mailto:sixerwyj@gmail.com" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a href="https://github.com/sixer51" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">
      
        Yijia Wu
        &nbsp;&bull;&nbsp;
      
      2020

      

      
      </p>
      <!-- Please don't remove this, keep my open source work credited :) -->
      <p class="theme-by text-muted">
        Theme by
        <a href="https://beautifuljekyll.com">beautiful-jekyll</a>
      </p>
      </div>
    </div>
  </div>
</footer>

  
    
  
    
  <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/main.js"></script>
    
  






  
  </body>
</html>
